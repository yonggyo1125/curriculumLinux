# 파이프, 필터 리디렉션

#### 파이프
- 파이프(pipe)란 2개의 프로그램을 연결하는 연결 통로의 의미다.
- 'ㅣ'를 사용한다 ([Shift] + \\ 를 누른 글자).
- 사용 예

```
# ls -l /etc | more  
		-> 'ls -1 /etc'를 입력하면 파일이 너무 많아서 
            1페이지에모두 담을 수 없으므로 1페이지씩 나눠서 보겠다는 의미다.
```

#### 필터
- 필터(filter)란 필요한 것만 걸러주는 명령어다. 
- <b>grep, tail, wc, sort, awk, sed</b> 명령어 등이 있다. 주로 파이프와 같이 사용된다.
- 사용 예

```
# ps -ef | grep bash     
            -> ps -ef 명령을 입력하면 모든 프로세스 번호를 출력하므로, 
			    bash라는 글자가 들어간 프로세스만 출력하게 한다.
				
# rpm -qa | grep dnf 
            -> 설치된 패키지 중에서 dnf라는 글자가 들어간 패키지를 출력한다. 
			    그냥 rpm -qa dnf 명령을 실행하면 dnf출력되지 않는다.
```

#### 리디렉션

- 리디렉션(redirection)은 표준 입출력의 방향을 바꿔준다.
- 표준 입력은 키보드, 표준 출력은 모니터지만 이를 파일로 처리하고 싶을 때 주로 사용한다.
- 사용 예

```
# ls -l > list.txt    
            -> Is I 명령 결과를 화면에 출력하지 않고 list.txt 파일에 저장하도록 한다. 
			    만약 list.txt 파일이 기존에 있다면 덮어쓴다(overwrite).
				
# ls -l >> list.txt
            -> 위와 같다. 단 list.txt 파일이 기존에 있다면 기존 내용에 이어서(append) 쓴다.
			
# sort < list.txt   
            -> list.txt 파일을 정렬해서 화면에 출력한다

# sort < list.txt > out.txt  
            -> list.txt 파일을 정렬해서 out.txt 파일에 쓴다.
```

* * * 
# 프로세스, 데몬, 서비스

## 프로세스

- 프로세스(Process)를 정의하면 '하드디스크에 저장된 실행 코드 (프로그램)가 메모리에 로딩되어 활성화된 것' 정도로 설명할 수 있다.

- 예를 들어 웹 브라우저 프로그램인 Firefox는 하드디스크 어딘가에 저장되어 있을 것이다. 이렇게 하드에 저장된 파일을 '프로그램'이라고 부르며, Firefox를 <b>실행해서 화면에 나타난 상태 (더 정확히는 메모리에 로딩된 상태)를 '프로세스'라고 부른다.</b>

- 프로세스와 관련된 필수 개념 및 용어는 다음과 같다.

### 포그라운드 프로세스

- 포그라운드 프로세스(Foreground Process)는 방금 얘기한 Firefox 등과 같이, <b>실행하면 화면에 나타나서 사용자와 상호 작용하는 프로세스를 말한다.</b> 화면에서 실행되는 것이 보이는 프로세스라고 생각하면 된다.

### 백그라운드 프로세스

- 백그라운드 프로세스(Background Process) 는 실행은 되었지만 <b>화면에 나타나지 않고 뒤에서 실행되는 프로세스를 말한다.</b> 예를 들어 바이러스 백신, 서버 데몬 등은 눈에 보이지 않지만 실행된다.

### 프로세스 번호

- 메모리에 로딩되어 활성화된 프로세스를 구분하려면 각각의 고유 번호가 필요하다. 이렇게 각각의 프로세스에 할당된 고유 번호를 프로세스 번호라고 한다. 
- 프로세스 번호가 필요한 이유는, 활성화된 프로세스를 메모리에서 강제로 제거하려면 프로세스 번호를 사용해야 하기 때문이다.

### 작업 번호

- 현재 실행되는 백그라운드 프로세스의 순차 번호를 의미한다.


### 부모 프로세스와 자식 프로세스

- 모든 프로세스는 혼자서 독립적으로 실행되는 것이 아니라 부모 프로세스의 하위에 종속되어 실행된다. 
- 예를 들어 Firefox 같은 경우 X 윈도 프로세스가 구동된 상태에서 실행되어야 하므로, X 윈도는 Firefox의 부모 프로세스이며 Firefox는 X 윈도의 자식 프로세스라고 부른다. 
- 여기서 Firefox를 그냥 두고 X 윈도만 강제 종료하면 Firefox가 계속 실행될까? 당연히 Firefox도 종료된다. 즉 부모 프로세스를 종료하면 그에 종속된 자식 프로세스도 모두 종료되는 것이다.


## 프로세스와 관련된 주요 명령

### ps

- 현재 프로세스의 상태를 확인하는 명령어로, 많은 옵션과 함께 사용할 수 있다. 
- 프로세스의 번호 및 상태를 확인할 때는 <b>ps -ef | grep 프로세스이름</b> 명령을 사용한다.

### kill

- 프로세스를 강제로 종료하는 명령어로, -9 옵션과 함께 사용하면 무조건 프로세스가 종료된다. 
- 예를 들어 응답하지 않고 무한 루프를 도는 프로세스는 <b>kill -9 프로세스번호</b> 명령을 실행해 강제 종료시키면 된다.

### pstree

- 부모 프로세스와 자식 프로세스의 관계를 트리 형태로 보여준다.

## 실습1

포그라운드 프로세스와 백그라운드 프로세스를 살펴보자.

#### step0 

- Server를 실행한다.

#### step1

무한 루프를 도는 프로세스를 중지해보자.

- 터미널에서 <b>yes \> /dev/null</b> 명령을 입력해 무한루프를 도는 단순한 프로세스를 생성하자.

![image1](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image1.png)

> <b>yes</b> 명령은 단순히 yes라는 글자를 화면에 무한출력한다. /dev/null 은 아무것도 아닌(아무 반응도 하지 않는) 장치를 말한다.

- 터미널 메뉴의 [파일] → [새창]을 선택해서 터미널을 하나 더 열고 <b<ps -ef | grep yes</b> 명령으로 프로세스 번호를 확인한다. 다음을 살펴보면 제일 앞에 나오는 root는 프로세스의 소유주고 그 다음 6559은 프로세스 번호며 그다음 2670는 부모 프로세스 번호다. 프로세스 번호를 확인했다면 <b>kill -9 6559</b> 명령을 입력해 프로세스를 종료한다.

> <b>ps -ef | grep 프로세스이름</b> 명령의 결과 중에서 'grep --color=auto yes'라는 글자가 들어간 행은 무시한다.

![image2](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image2.png)

![image3](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image3.png)

- kill 명령으로 프로세스를 종료하면 기존의 다른 터미널에서 실행되던 것이 자동으로 종료되는 것을 확인할 수 있다. 현재 작동 중인 포그라운드 프로세스를 그냥 종료하려면 프로세스가 실행되고 있는 터미널에서 Ctrl + C 를 눌러도 된다.

#### step2

포그라운드 프로세스 → 백그라운드 프로세스 포그라운드 프로세스로 프로세스 상황을 바꿔보자.

- 다시 <b>yes > /dev/null</b> 명령을 입력해 포그라운드 프로세스를 생성한다.
- Ctrl + Z 를 눌러 프로세스를 일시 중지시키고, <b>bg</b> 명령을 입력해서 잠시 중지된 프로세스를 백그라운드 프로세스로 계속 실행시킨다

![image4](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image4.png)

- <b>jobs</b> 명령을 입력하면 현재 백그라운드로 가동 중인 프로세스를 확인할 수 있다. 제일 앞에 나오는 것이 작업 번호다. <b>fg 작업번호</b> 명령을 입력하면 다시 포그라운드 프로세스로 만들 수 있다.

![image5](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image5.png)

- Ctrl + C를 눌러 프로세스를 종료한다.

#### step3

명령을 실행할 때 처음부터 백그라운드로 실행되도록 해보자

- gedit 명령을 입력해서 gedit을 실행한다. 그런데 명령을 입력한 터미널은 더 이상 사용할 수 없다.

- gedit을 종료하고 이번에는 <b>gedit &</b> 명령을 입력한다. 터미널을 계속 사용할 수 있다. 즉 <b>명령어 뒤에 붙이는 &는 백그라운드로 프로세스를 실행하겠다는 의미</b>다.

![image6](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image6.png)

- 이처럼 프로세스 실행 시 바로 백그라운드 프로세스로 만들 수 있다. 즉 모든 명령어 뒤에 &를 붙이면 자동으로 백그라운드로 실행된다. 그런데 사용 시 주의할 사항이 있다.

- firefox, gedit 등은 별도의 창에서 실행되므로 백그라운드로 실행해도 아무 문제가 없다. 또 xz, bzip2, gzip 같은 압축 프로그램으로 대용량 압축 파일을 만든다면 시간이 오래 걸릴 텐데 이럴 때 백그라운드 프로세스로 실행하면 유용할 것이다.

- 하지만 vi 에디터와 같이 현재 터미널에서 입출력해야 하는 프로세스를 백그라운드 프로세스로 실행하는 것은 아무런 의미가 없다. 즉 다음과 같이 <b>vi 파일이름 &</b> 명령을 실행해도 화면에서 입출력할 수 없으므로 무의미하다는 뜻이다.

![image7](https://raw.githubusercontent.com/yonggyo1125/curriculumLinux/master/Linux1/10%EC%9D%BC%EC%B0%A8(3h)%20-%20%ED%8C%8C%EC%9D%B4%ED%94%84%2C%ED%95%84%ED%84%B0%2C%EB%A6%AC%EB%94%94%EB%A0%89%EC%85%98%2C%20%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4%2C%20%EB%8D%B0%EB%AA%AC%2C%20%EC%84%9C%EB%B9%84%EC%8A%A4/images/image7.png)

## 서비스 

- <b>데몬(daemon)이라고도 부르는 서비스(service)는 서버 프로세스를 말한다.</b> 즉 서비스는 웹서버, 네임서버, DB 서버 등의 프로세스를 지칭한다. 또는 웹 서버 데몬, 네임 서버 데몬 등으로 부르기도 한다. 
- 서비스는 눈에 보이지 않지만 현재 시스템에서 동작 중인 프로세스이므로 백그라운드 프로세스의 일종이라고 할 수 있다. 바로 이어서 나오는 서버 유형과 밀접한 관련이 있으므로, 우선은 '서비스=데몬서버 프로세스' 정도로만 이해해두자.

